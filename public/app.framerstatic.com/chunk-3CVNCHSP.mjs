import{a as C}from"https://app.framerstatic.com/chunk-R3NZHMAQ.mjs";import{a as b,b as R,f as I,i as g,k as W}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{a as D,b as P}from"https://app.framerstatic.com/chunk-JX6NUTD4.mjs";import{g as O}from"https://app.framerstatic.com/chunk-TL2YQ7KN.mjs";import{v as S}from"https://app.framerstatic.com/chunk-WWEGIMHT.mjs";import{e as k,j as f}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";function j(t,a,s=[]){let o=[];for(let[n,e]of t.entries()){if(!g(e.submenu)&&!I(e.submenu))continue;let{submenu:r,...p}=e,h=s?[...s,n]:[n],i={...p,path:h};if(i.type==="separator"){if(n===0||n===t.length-1||o[o.length-1]?.type==="separator")continue;o.push(i);continue}if(e.role&&a?.validateAction){let{states:u,options:l}=a.validateAction(e.role),d=u[e.role],{label:A,checked:y,visible:M}=l[e.role]??{};R(A)&&(i.label=A),g(e.checked)&&b(y)&&(i.checked=y),g(e.visible)&&b(M)&&(i.visible=M),g(e.enabled)&&b(d)&&(i.enabled=d)}if(e.visible===!1)continue;if(r){let u=j(r,a,h),l={...i,submenu:u};o.push(l);continue}let c=z(i,a);o.push(c)}return o.length>0&&o[o.length-1]?.type==="separator"&&o.pop(),o.length>0&&o[0]?.type==="separator"&&o.shift(),o}function z(t,a){if(!a)return t;let{appAccelerators:s,appAcceleratorsWindows:o}=a;if(!s||!o)return t;let{role:n}=t;if(!n)return t;let e={...t};return!C&&!t.acceleratorWindows&&(e.acceleratorWindows=o[n]),t.accelerator||(e.accelerator=s[n]),e}var q=S("wantsNativeTextActions");function V(t=document.activeElement){if(!(t instanceof HTMLElement))return!1;if(t.classList.contains("wantsNativeTextAction")||t instanceof HTMLIFrameElement)return!0;if(t instanceof HTMLInputElement)switch(t.type){case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"text":case"time":case"url":case"week":return!0;case"checkbox":case"color":case"file":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return q.reportErrorOncePerMinute("Unhandled input type: "+t.type),!1}return t instanceof HTMLTextAreaElement||t instanceof HTMLAnchorElement||t.closest("a")?!0:t.isContentEditable}var T=k(D());var B=k(P());function x(t){return t.wantsActions?t.wantsActions():!0}function E(t,a,s){return t.wantsAction?t.wantsAction(a,s):!0}function H(t,a){return t.optionsForAction?t.optionsForAction(a):void 0}var F;(o=>{function t(n){return new s(n)}o.chain=t;function a(n,e){return n&&n instanceof s?n.actionToTargetMap[e]:n}o.functionTarget=a;class s{constructor(e){f(this,"actionToTargetMap",{});f(this,"wantedActions",[]);this.then(e)}then(e){this.wantedActions=this.wantedActions.concat(e.wantedActions);let r=this.actionToTargetMap,p=e.wantedActions;for(let h of p)r[h]=r[h]||e;return this}wantsAction(e,r){let p=this.actionToTargetMap[e];return!p||!x(p)?!1:E(p,e,r)}optionsForAction(e){let r=this.actionToTargetMap[e];if(r)return H(r,e)}}})(F||={});var m=class extends Event{constructor(){super(...arguments);f(this,"actionIdentifier");f(this,"actionArgument")}};f(m,"eventType","vekter-action-dispatch-event");var v=class extends Event{constructor(){super(...arguments);f(this,"invalidatedActions");f(this,"validatedActionStates");f(this,"validatedActionOptions")}};f(v,"eventType","vekter-action-validation-event");function tt({target:t,engine:a,children:s,style:o,global:n}){let e=(0,T.useRef)(null),r=(0,T.useCallback)(i=>{let c=i.actionIdentifier;if(!c)return;let u=F.functionTarget(t,c);if(!u||!u.wantedActions.includes(c)||!x(u))return;let l=u[c];if(!W(l))return;let d=E(u,c,i);if(!d||(i.preventDefault(),i.stopPropagation(),d!==!0))return;a.setEditReason(c);let A=l.bind(u);a.scheduler.wrapHandler(A)(i.actionArgument)},[a,t]),p=(0,T.useCallback)(i=>{let{invalidatedActions:c,validatedActionStates:u,validatedActionOptions:l}=i;if(!(!c||!u||!l)&&t){for(let d of t.wantedActions)if(c.has(d)){c.delete(d);let A=x(t)?E(t,d,i):!1;if(u[d]=A,A===!0||A===!1){let y=H(t,d);y&&(l[d]=y)}}c.size===0&&(i.preventDefault(),i.stopPropagation())}},[t]);(0,T.useEffect)(()=>{if(!e.current)return;let i=(n?document.documentElement:null)||e.current;return i.addEventListener(m.eventType,r),i.addEventListener(v.eventType,p),()=>{i.removeEventListener(m.eventType,r),i.removeEventListener(v.eventType,p)}},[n,r,p]);let h=(0,T.useCallback)(i=>{!V(i.target)&&!O.isDebugBuild&&i.preventDefault()},[]);return(0,B.jsx)("div",{ref:e,onContextMenu:h,style:o,children:s})}function et(t,a){let s=document.activeElement;if(!s)throw Error("No active element for action dispatch");let o=new m(m.eventType,{bubbles:!0});return o.actionIdentifier=t,o.actionArgument=a,s.dispatchEvent(o)}function G(t){let a=document.activeElement;if(!a)throw Error("No active element for action validation");let s=new Set;for(let r of t)s.add(r);let o={},n={},e=new v(v.eventType,{bubbles:!0});return e.invalidatedActions=s,e.validatedActionStates=o,e.validatedActionOptions=n,a.dispatchEvent(e),{states:o,options:n}}var N=[],U=[];function nt(t){N.push(t)}function ot(t){U.push(t)}function it(t){let a=t==="*"?Object.keys(w):[t];N.forEach(n=>n());let{states:s,options:o}=G(a);Object.assign(w,s),Object.assign(L,o);for(let n of a)w[n]=s[n]||(n==="undo"||n==="redo"||n==="delete"?"native":!1);return U.forEach(n=>n()),{states:w,options:L}}var w={},L={};export{V as a,F as b,tt as c,et as d,nt as e,ot as f,it as g,j as h};
//# sourceMappingURL=https://app.framerstatic.com/chunk-3CVNCHSP.mjs.map
